# 读书笔记

###### 阅读者：hauk0101

## 简介
书名：《Node与Express开发》 <br>
作者： Ethan Brown <br>
译者： 吴海星、苏文 <br>
出版发行：人民邮电出版社 <br>
出版时间：2015年2月

## 读后感
　　
## 总结
### 第1章 初识Express

这一章主要介绍了Javascript、NodeJS以及Express的一些简介，以及这几者之间的关系。
根据我的理解就是：
1. Node和Express都是基于Javascript语言进行开发和使用的，其中Node是Web服务器（同时也包含其相关的生态系统），类似于PHP、Ruby等语言和框架。
2. Express是基于Node的Web程序框架。
3. 其中Node和Express都可以正常的同数据库如MySQL、MongoDB等等进行操作和通信。

### 第2章 从Node开始

这一章主要是介绍了Node关于Web服务器相关的简单开发案例。
据我的理解就是：
1. Node + Node生态的其它模块也可以构建Web服务器。
2. npm是Node生态环境的相关包管理工具。
3. 向客户端返回一个"Hello World"输出、事件驱动编程介绍、路由介绍、静态资源服务等基本案例。

### 第3章 省时省力的Express

这一章主要介绍了如何安装Express框架，以及其自带的一些脚手架工具、工程文件目录等等。都是属于比较简单的说明，没有太复杂的代码。

### 第4章 工欲善其事，必先利其器

这一章主要说明了版本控制的重要性，同时推荐读者使用Git版本控制工具，并简单介绍了相关应用。

### 第5章 质量保证

这一章主要说明了QA的重要性，但并没有主要的使用方法，更多的是简要的说明了一下QA&测试对于整个项目的重要性，以及一些质量保证的步骤简单示例。因此只能作为一个了解的参考，并没有深入讲解。

### 第6章 请求和响应对象

在用Express构建Web服务器时，大部分工作都是从请求对象开始，到响应对象终止。

> URL的组成部分

|协议|主机名|端口|路径|查询字符串|信息片段|
|---|---|---|---|---|---|
|http://|localhost|:3000|/about|?test=1|#q=express|
|https://|google.com|:443(默认)|/..| ..|... |
|协议确定如何传输请求，主要处理http和https，常见的还有ftp,file|主机名识别服务器|每台服务器都有一些列端口号，其中80端口为http的默认端口，443为https的默认端口，自定义端口则需要大于1023|URL中影响应用程序的第一个组成部分通常是路径，路径是应用中的页面或其他资源的唯一标识|查询字符串是一种键值对集合，是可选的，它以?开头，以&分开，以=号作为键值对的连接符|大多是用于前端的“路由”功能|

### 第7章 Handlebars模板引擎

本章主要介绍了书中所使用的Express模板引擎，而由于我个人在实际项目中使用的ejs模板引擎，所以对此引擎暂时只是了解阶段，并没有太深入的研究学习。

> 不过文中介绍了使用JS模板引擎的情景，如下所示：

* 你必须不断地考虑哪些字符需要转义以及如何转义。
* 使用JavaScript来生成那些自身包含JavaScript代码的HTML会很快让你抓狂。
* 你通常会是去编辑器的语法高亮显示和其他方便的语言特性。
* 很难发现格式不正确的HTML。
* 很难直观地分析。
* 很难让别人读懂你的代码。

> 视图通常表现为网站上的各个页面，默认情况下，Express会在views子目录中查找视图。

### 第8章 表单处理

>向服务器发送客户端数据

大体上讲，向服务器发送客户端数据有两种方式：查询字符串和请求正文。通常，如果是使用查询字符串，就发起了一个`GET`请求；如果是使用请求正文，就发起了一个`POST`请求。

_tips:_ `GET`和`POST`的请求方式和安全性关系都不大，如果想要保证传输数据的安全，应该使用`HTTPS`协议。

> HTML表单

对于服务器而言，表单最重要的属性是`<input>`域中的`name`属性。(之前在做文件上传时没有重视name的意义，算是趟过一个小坑)
_tips:_ 注意隐藏域：它不会呈现在浏览器中，但是，你不能使用它存放秘密和敏感信息；因为只要用户查看页面源文件，隐藏域就会暴露出来。

> 编码

不同内容对应的编码格式不同，如文本、文件、多媒体等等。

> 处理表单的不同方式

* 前端页面主要有两种提交表单的方式，一种是`ajax`，一种是`<form></form>`标签，但两者在使用时都需要标注提交的类型，即`GET`或者`POST`。
* express处理表单的方式，主要有：
	* 直接响应HTML，即直接向前端返回一个HTML，如果用户尝试重新加载页面，这种方法就会产生警告，并且会影响书签和后退按钮。
	* 302重定向，目前已被滥用，建议用303
	* 303重定向
	
* 对表单不同的处理方式是由于`<form></form>`提交表单之后会重新刷新页面，而`ajax`与它的区别在于可以异步与后台传输数据，不会重新刷新页面。因此，在前端选择表单提交时，应该考虑用户体验，做出最合适的选择。

_tips：_个人理解，对于express而言，在开发的时候可以考虑`<form></form>`表单的提交需要考虑如何在页面中继续跳转到其他页面的选择，而`ajax`表单提交更倾向于开发对应的接口进行数据交互。

> Express表单处理

* 如果使用`GET`进行表单提交，那么表单域在`req.query`对象中。
* 如果使用`POST`进行表单提交，则需要引入中间件`body-parser`, 之后表单域会出现在`req.body`中。
* 关于重定向
	* 301重定向是“永久”的，意味着浏览器会缓存重定向目标。如果使用301重定向并且视图第二次提交表单，浏览器会绕过整个重定向之前的逻辑，而直接进入重定向之后的页面，因为它正确地认为重定向是永久性的。
	* 303（或302）重定向则告诉浏览器，当前请求有效，可以在这里找到响应，并且不会缓存重定向目标。
	

> 处理Ajax表单

当仅为`GET`,`POST`两种请求时，可以视为`<form></form>`的相同处理方法，如果有其它类型的提交，可以根据情况再做详细处理。

> 文件上传

个人在开发时的一些见解：
* Express中文件上传可以借助其它中间件
* 文件上传时注意类型
* 文件上传时注意name，其实跟表单提交一样，因为之前犯过类似的错误

> jQuery文件上传

_tips：_ 再需要用的时候查看API或者参考网上实例即可，暂时没必要深究。

   