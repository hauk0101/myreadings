# 读书笔记

##### 阅读者：hauk0101

## 简介

书名：《你不知道的JavaScript(上卷)》<br/>
作者：Kyle Simpson <br/>
译者：赵望野 梁杰 <br/>
出版发行：人民邮电出版社 <br/>
出版时间：2015年4月

## 读后感

## 总结
### 第一部分 作用域和闭包
#### 第1章 作用域是什么

* 作用域是一套规则，用于确定在何处以及如何查找变量。如果查找的目的是对变量进行赋值，那么就会使用 LHS 查询；如果目的是获取变量的值，就会使用 RHS 查询。
赋值操作会导致 LHS 查询。= 操作符或调用函数时传入参数的操作都会导致关联作用域的赋值操作。

* JavaScript 引擎首先会在代码执行前对其进行编译，在这个过程中，像 `var a = 2` 这样的声明会被分解成两个独立的步骤：

    * 首先，var a 在其作用域中声明新变量。这会在最开始的阶段，也就是代码执行前进行。
    * 接下来，a = 2 会查询（LHS 查询）变量 a 并对其进行赋值。

* LHS 和 RHS 查询都会在当前执行作用域中开始，如果有需要（也就是说没有它们没有找到所需的变量），就会向上级作用域继续查找目标变量，这样每次上升一级作用域，最后抵达全局作用域，无论找到或者没找到都将停止。
* 不成功的 RHS 引用会导致抛出 ReferenceError 异常。不成功的 LHS 引用会导致自动隐式的创建一个全局变量（非严格模式下），该变量使用 LHS 引用的目标作为标识符，或者抛出 ReferenceError 异常（严格模式下）。

* 个人理解及注意事项：
    * 个人理解：所谓的作用域其实就是 JS 引擎在编译阶段寻找变量过程中所遵守的一种规则，即如果当前作用域中没有该对象的声明，则会到上一级作用域中查找，直到全局作用域（window) 中，无论是否存该变量，都会停止查找。
    * 注意事项：
        * LHS 和 RHS 是本质是 JS 引擎在查找变量时的两种类型，LHS 可以理解为赋值相关的查找，RHS 可以理解为获取变量的值相关的查找。
        * LHS 和 RHS 的关系：
            * 相同点：两者都可以从当前作用域依次向上查找，知道全局作用域停止。
            * 不同点：
                * RHS 如果没有找到所有作用域中对应变量的存在，则会抛出 ReferenceError 异常，也就是我们常见的 a is not define;
                * 在非严格模式下，LHS 如果没有找到所有作用域中对应变量的存在，则会自动隐式的创建一个全局变量；
                * 在严格模式下，如果在所有的作用域中对应的变量都不存在，则 RHS 和 LHS 都会抛出 ReferenceError 异常，也就是我们常见的 a is not define。

#### 第2章 词法作用域

* 词法作用域意味着作用域是由书写代码时函数声明的位置来决定的。编译的词法分析阶段基本能够知道全部标识符在哪里以及是如何声明的，从而能够预测在执行过程中如何对它们进行查找。

* JavaScript 中有两个机制可以“欺骗”词法作用域： eval(...) 和 width 。前者可以对一段包含一个或多个声明的“代码”字符串进行演算，并借此来修改已经存在的词法作用域（在运行时）。后者本质上是通过将一个对象的引用当做作用域来处理，将对象的属性当作作用域中的标识符来处理，从而创建了一个新的词法作用域（同样是在运行时）。

* 这两个机制的副作用是引擎无法在编译时对作用域查找进行优化，因为引擎只能谨慎地认为这样的优化是无效的。使用这其中任何一个机制都将导致代码运行变慢。不要使用它们。